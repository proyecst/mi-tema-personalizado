{%- liquid
  assign selected_collection = section.settings.featured_collection
  assign max_products = section.settings.product_limit
  assign style_grid = section.settings.grid_style
-%}

<section class="section-advanced-list" style="padding: 60px 0;">
  <div class="container page-width">
    {% if section.settings.section_heading != blank %}
      <h2 style="text-align: center; margin-bottom: 40px;">{{ section.settings.section_heading }}</h2>
    {% endif %}

    {% if selected_collection != blank and selected_collection.products_count > 0 %}
      <div class="product-grid grid grid--{{ style_grid }}" style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px;">
        {% for product in selected_collection.products limit: max_products %}
          <div class="grid__item">
            {% render 'product-card', 
              product_card_product: product, 
              show_badge: true, 
              grid_style: style_grid 
            %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      <div class="center" style="padding: 40px; border: 1px dashed #ccc;">
        <p>Por favor, selecciona una colección con productos en la configuración.</p>
      </div>
    {% endif %}
  </div>
</section>

{% schema %}
{
  "name": "Listado Profesional",
  "settings": [
    { "type": "text", "id": "section_heading", "label": "Título de la Sección", "default": "Productos Destacados" },
    { "type": "collection", "id": "featured_collection", "label": "Colección" },
    { "type": "range", "id": "product_limit", "min": 2, "max": 12, "step": 2, "label": "Límite de Productos", "default": 4 },
    { "type": "select", "id": "grid_style", "label": "Estilo", "options": [
        {"value": "simple", "label": "Simple"},
        {"value": "border", "label": "Con Borde"}
      ], "default": "simple" }
  ],
  "presets": [ { "name": "Listado Profesional" } ]
}
{% endschema %}