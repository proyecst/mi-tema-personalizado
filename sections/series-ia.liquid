<style>
  @import url('https://fonts.googleapis.com/css2?family=Michroma&display=swap');
</style>

<section class="series-destacadas-ia" id="series-ia-{{ section.id }}">
  <div class="container-width">
    {% if section.settings.title != blank %}
      <div class="heading-ia">
        <h2 class="title-ia">{{ section.settings.title }}</h2>
        <p class="subtitle-ia">Controlado por Inteligencia Artificial</p>
      </div>
    {% endif %}

    <div class="series-grid-ia" id="grid-principal">
      {% for block in section.blocks %}
        <div class="card-serie-ia" 
             data-name="{{ block.settings.title | downcase }}" 
             id="block-{{ block.id }}">
          <a href="{{ block.settings.link }}" class="card-link">
            <div class="img-container">
              {% if block.settings.image != blank %}
                <img src="{{ block.settings.image | img_url: '600x600' }}" alt="{{ block.settings.title }}">
              {% else %}
                {{ 'collection-1' | placeholder_svg_tag: 'placeholder-svg' }}
              {% endif %}
              <div class="scan-line"></div>
            </div>
            <div class="info-ia">
              <h3 class="k-ethno-font">{{ block.settings.title }}</h3>
              <span class="status-bot">SISTEMA ONLINE</span>
            </div>
          </a>
        </div>
      {% endfor %}
    </div>
  </div>
</section>

<div class="ia-floating-panel">
  <div class="ia-chat-box" id="ia-box">
    <div class="ia-header-chat k-ethno-font">KIESLECT CORE AI</div>
    <div class="ia-messages" id="ia-log">
      <div class="bot-txt">Escribe una serie (ej: "Amoled") y la buscaré por ti.</div>
    </div>
    <div class="ia-input-group">
      <input type="text" id="ia-input" placeholder="Comando de voz/texto..." onkeypress="if(event.key==='Enter') procesarOrden()">
      <button onclick="procesarOrden()" class="k-ethno-font">EXE</button>
    </div>
  </div>
  <div class="ia-btn-toggle" onclick="toggleIA()">
    <div class="ai-core"></div>
  </div>
</div>

<style>
  /* --- RESET TIPOGRÁFICO --- */
  .k-ethno-font {
    font-family: 'Michroma', sans-serif !important;
    text-transform: uppercase !important;
    letter-spacing: 2px !important;
  }

  .series-destacadas-ia { 
    background: #000; 
    padding: 80px 20px; 
    color: #fff; 
    font-family: sans-serif;
  }

  .heading-ia { text-align: center; margin-bottom: 60px; }

  /* TÍTULO PRINCIPAL (EFECTO ETHNOCENTRIC) */
  .title-ia { 
    font-family: 'Michroma', sans-serif !important;
    font-size: clamp(1.8rem, 5vw, 3rem) !important; 
    font-weight: 700 !important;
    margin: 0 !important; 
    text-transform: uppercase !important;
    letter-spacing: 8px !important; /* Espaciado extra estilo Ethnocentric */
    background: linear-gradient(120deg, rgba(255,255,255,0.1) 30%, #00D1FF 50%, rgba(255,255,255,0.1) 70%);
    background-size: 200% 100%;
    -webkit-background-clip: text;
    background-clip: text;
    color: rgba(255, 255, 255, 0.9);
    animation: iaShineTitle 4s infinite linear;
  }

  @keyframes iaShineTitle {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
  }

  .subtitle-ia { 
    font-family: 'Michroma', sans-serif !important;
    color: #555; 
    letter-spacing: 4px; 
    font-size: 10px; 
    text-transform: uppercase;
    margin-top: 15px;
    animation: pulseGhost 3s infinite ease-in-out;
  }

  /* TARJETAS */
  .series-grid-ia { 
    display: grid; 
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); 
    gap: 30px; 
    max-width: 1300px; 
    margin: 0 auto; 
  }

  .card-serie-ia { 
    background: #0a0a0a; 
    border: 1px solid #1a1a1a; 
    border-radius: 0px; /* Bordes rectos para look más industrial */
    overflow: hidden; 
    transition: all 0.4s ease;
    position: relative;
  }

  .card-serie-ia.active-ia { 
    border-color: #00D1FF; 
    box-shadow: 0 0 40px rgba(0, 209, 255, 0.2); 
    transform: scale(1.02); 
  }

  .info-ia h3 { 
    font-family: 'Michroma', sans-serif !important;
    font-size: 14px !important;
    color: #fff !important;
    margin-bottom: 15px;
  }

  .status-bot { 
    font-family: 'Michroma', sans-serif !important;
    font-size: 8px; 
    color: #00D1FF; 
    border: 1px solid #00D1FF; 
    padding: 3px 10px; 
    letter-spacing: 1px;
  }

  /* PANEL CHAT IA */
  .ia-header-chat { 
    background: #00D1FF; 
    color: #000; 
    padding: 15px; 
    font-size: 10px; 
    text-align: center;
  }

  .ia-input-group input { 
    font-family: sans-serif; /* Texto legible para escribir */
    font-size: 13px;
  }

  .ia-input-group button { 
    font-size: 10px;
    padding: 0 20px;
  }

  .bot-txt { 
    font-family: sans-serif;
    line-height: 1.4;
  }

  /* ANIMACIONES */
  @keyframes scanning { 0% { top: 0%; } 100% { top: 100%; } }
  @keyframes pulse-core { 0% { transform: scale(1); opacity: 1; } 100% { transform: scale(2.5); opacity: 0; } }
  @keyframes pulseGhost { 0%, 100% { opacity: 0.4; } 50% { opacity: 0.9; color: #00D1FF; } }

  .card-link { text-decoration: none; color: inherit; }
  .img-container { position: relative; aspect-ratio: 1; background: #111; overflow: hidden; }
  .img-container img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
  .card-serie-ia:hover img { transform: scale(1.1); }
</style>

<script>
function toggleIA() {
  document.getElementById('ia-box').classList.toggle('visible');
}

function procesarOrden() {
  const input = document.getElementById('ia-input');
  const log = document.getElementById('ia-log');
  const orden = input.value.toLowerCase().trim();
  const tarjetas = document.querySelectorAll('.card-serie-ia');
  
  if(!orden) return;

  log.innerHTML += `<div style="text-align:right; color:#00D1FF; font-family:sans-serif; margin-bottom:10px; font-size:12px;">> ${input.value}</div>`;
  input.value = "";

  setTimeout(() => {
    let hallado = false;
    
    if(orden.includes("todo") || orden.includes("reiniciar") || orden.includes("limpiar")) {
      tarjetas.forEach(t => { t.classList.remove('dim-ia', 'active-ia'); });
      log.innerHTML += `<div class="bot-txt">SISTEMA REINICIADO. UNIDADES LOCALIZADAS.</div>`;
    } else {
      tarjetas.forEach(t => {
        const nombre = t.getAttribute('data-name');
        if(nombre.includes(orden)) {
          t.classList.add('active-ia');
          t.classList.remove('dim-ia');
          t.scrollIntoView({ behavior: 'smooth', block: 'center' });
          hallado = true;
        } else {
          t.classList.add('dim-ia');
          t.classList.remove('active-ia');
        }
      });

      if(hallado) {
        log.innerHTML += `<div class="bot-txt">ANÁLISIS COMPLETO: SERIE "${orden.toUpperCase()}" DETECTADA.</div>`;
      } else {
        tarjetas.forEach(t => { t.classList.remove('dim-ia', 'active-ia'); });
        log.innerHTML += `<div class="bot-txt">ERROR: NO SE ENCUENTRA "${orden.toUpperCase()}". REINTENTE.</div>`;
      }
    }
    log.scrollTop = log.scrollHeight;
  }, 600);
}
</script>

{% schema %}
{
  "name": "IA Series Ethnocentric",
  "settings": [
    { "type": "text", "id": "title", "label": "Título", "default": "SERIES KIESLECT" }
  ],
  "blocks": [
    {
      "type": "serie",
      "name": "Serie",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Imagen" },
        { "type": "text", "id": "title", "label": "Nombre de la Serie" },
        { "type": "url", "id": "link", "label": "Enlace" }
      ]
    }
  ],
  "presets": [
    { "name": "IA Series Ethnocentric" }
  ]
}
{% endschema %}