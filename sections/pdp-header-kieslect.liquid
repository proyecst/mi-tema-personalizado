<div class="k-pdp-header" style="background: {{ section.settings.bg }};">
  <div class="k-container">
    
    <nav class="k-breadcrumb" aria-label="breadcrumbs">
      <a href="/">Inicio</a>
      <span class="sep">/</span>
      {% if collection %}
        <a href="{{ collection.url }}">{{ collection.title }}</a>
      {% else %}
        <a href="/collections/all">Smartwatches</a>
      {% endif %}
      <span class="sep">/</span>
      <span class="current">{{ product.title }}</span>
    </nav>

    <div class="k-badges">
      {% comment %} Lógica de Fecha Optimizada {% endcomment %}
      {%- assign date_published = product.published_at | date: '%s' | plus: 0 -%}
      {%- assign date_now = 'now' | date: '%s' | plus: 0 -%}
      {%- assign diff_seconds = date_now | minus: date_published -%}
      {%- assign diff_days = diff_seconds | divided_by: 86400 -%}

      {% comment %} NUEVO automático (30 días) {% endcomment %}
      {% if diff_days < 30 %}
        <span class="k-badge k-new">NUEVO</span>
      {% endif %}

      {% comment %} OFERTA automática {% endcomment %}
      {% if product.compare_at_price > product.price %}
        <span class="k-badge k-sale">OFERTA</span>
      {% endif %}

      {% comment %} Etiquetas por TAGS {% endcomment %}
      {% for tag in product.tags %}
        {% assign tag_clean = tag | downcase %}
        {% if tag_clean contains 'limitada' %}
          <span class="k-badge k-limited">EDICIÓN LIMITADA</span>
        {% elsif tag_clean contains 'top' or tag_clean contains 'vendido' %}
          <span class="k-badge k-best">MÁS VENDIDO</span>
        {% elsif tag_clean contains 'exclusivo' %}
          <span class="k-badge k-exclusive">EXCLUSIVO</span>
        {% endif %}
      {% endfor %}
    </div>

  </div>
</div>

<style>
  .k-pdp-header { 
    padding: 15px 0; 
    border-bottom: 1px solid #333; 
    background-color: #000;
  }
  .k-container { 
    max-width: 1400px; 
    margin: 0 auto; 
    padding: 0 40px; 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
  }
  
  .k-breadcrumb { font-size: 11px; text-transform: uppercase; letter-spacing: 1.5px; }
  .k-breadcrumb a { color: #888; text-decoration: none; transition: 0.3s; }
  .k-breadcrumb a:hover { color: #e62e04; }
  .k-breadcrumb .sep { margin: 0 10px; color: #444; }
  .k-breadcrumb .current { color: #fff; font-weight: 600; }

  .k-badges { display: flex; gap: 10px; }
  .k-badge { 
    padding: 5px 12px; 
    font-size: 9px; 
    font-weight: 800; 
    letter-spacing: 0.5px;
    border-radius: 3px;
    display: inline-block;
  }
  
  .k-new { background: #00ff88; color: #000; }
  .k-sale { background: #e62e04; color: #fff; }
  .k-limited { background: #ffea00; color: #000; }
  .k-best { background: #2979ff; color: #fff; }
  .k-exclusive { border: 1px solid #e62e04; color: #e62e04; }

  @media (max-width: 768px) {
    .k-container { flex-direction: column; align-items: flex-start; gap: 12px; padding: 0 20px; }
    .k-badges { flex-wrap: wrap; }
  }
</style>

{% schema %}
{
  "name": "K Header Detalle",
  "settings": [
    { "type": "color", "id": "bg", "label": "Color de Fondo", "default": "#000000" }
  ],
  "presets": [{ "name": "K Header Detalle" }]
}
{% endschema %}