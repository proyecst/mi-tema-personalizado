<div class="ai-launcher" onclick="toggleAIChat()">
  <div class="ai-pulse"></div>
  <svg viewBox="0 0 24 24"><path fill="#00D1FF" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>
</div>

<div id="ai-chat-box" class="ai-window">
  <div class="ai-header">
    <div class="ai-status"><div class="status-indicator"></div> KIESLECT GPT-CORE</div>
    <button onclick="toggleAIChat()" class="close-ai">âœ•</button>
  </div>
  <div id="ai-messages" class="ai-body">
    <div class="ai-msg bot"><small>SYSTEM</small>Modo IA Completa activado. PregÃºntame lo que quieras.</div>
  </div>
  <div id="aiTyping" class="ai-typing" style="display:none;"><span></span><span></span><span></span></div>
  <div class="ai-footer">
    <input type="text" id="ai-input" placeholder="Pregunta lo que sea..." onkeypress="handleEnter(event)">
    <button onclick="askAI()">ðŸš€</button>
  </div>
</div>

<style>
  :root { --k-neon: #00D1FF; --k-dark: #0a0a0a; }
  .ai-window { position: fixed; bottom: 100px; right: 20px; width: 350px; height: 500px; background: var(--k-dark); border: 1px solid var(--k-neon); border-radius: 20px; display: none; flex-direction: column; z-index: 99999; color: white; font-family: sans-serif; overflow: hidden; }
  .ai-launcher { position: fixed; bottom: 20px; right: 20px; width: 60px; height: 60px; background: #000; border: 2px solid var(--k-neon); border-radius: 50%; cursor: pointer; z-index: 99999; display: flex; align-items: center; justify-content: center; }
  .ai-body { flex: 1; padding: 15px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
  .ai-msg { padding: 10px; border-radius: 10px; font-size: 13px; max-width: 80%; }
  .ai-msg.bot { background: #1a1a1a; align-self: flex-start; border: 1px solid #333; }
  .ai-msg.user { background: var(--k-neon); color: black; align-self: flex-end; font-weight: bold; }
  .ai-footer { padding: 10px; display: flex; background: #111; }
  .ai-footer input { flex: 1; background: #222; border: none; color: white; padding: 10px; border-radius: 5px; outline: none; }
  .ai-footer button { background: var(--k-neon); border: none; padding: 10px; margin-left: 5px; border-radius: 5px; cursor: pointer; }
  .ai-typing span { width: 6px; height: 6px; background: var(--k-neon); border-radius: 50%; display: inline-block; animation: bounce 1s infinite; }
  @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-5px); } }
</style>

<script>
  const OPENAI_API_KEY = "TU_API_KEY_AQUI"; // REEMPLAZA ESTO

  function toggleAIChat() {
    const chat = document.getElementById('ai-chat-box');
    chat.style.display = chat.style.display === 'flex' ? 'none' : 'flex';
  }

  function handleEnter(e) { if (e.key === 'Enter') askAI(); }

  async function askAI() {
    const input = document.getElementById('ai-input');
    const msgContainer = document.getElementById('ai-messages');
    const typing = document.getElementById('aiTyping');
    const userText = input.value.trim();

    if (!userText) return;

    // Agregar mensaje usuario
    addMsg(userText, 'user');
    input.value = "";
    typing.style.display = "block";
    msgContainer.scrollTop = msgContainer.scrollHeight;

    try {
      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "Authorization": `Bearer ${OPENAI_API_KEY}`
        },
        body: JSON.stringify({
          model: "gpt-3.5-turbo",
          messages: [
            {role: "system", content: "Eres el asistente experto de la tienda de relojes Kieslect. Responde de forma futurista, profesional y ayuda con cualquier duda general o tÃ©cnica."},
            {role: "user", content: userText}
          ]
        })
      });

      const data = await response.json();
      const aiText = data.choices[0].message.content;
      addMsg(aiText, 'bot');
    } catch (error) {
      addMsg("Error de conexiÃ³n. Verifica la API Key.", 'bot');
    } finally {
      typing.style.display = "none";
      msgContainer.scrollTop = msgContainer.scrollHeight;
    }
  }

  function addMsg(text, type) {
    const container = document.getElementById('ai-messages');
    const div = document.createElement('div');
    div.className = `ai-msg ${type}`;
    div.innerHTML = type === 'bot' ? `<small style="display:block;color:#00D1FF;font-size:9px">KIESLECT CORE</small>${text}` : text;
    container.appendChild(div);
  }
</script>

