<style>
  :root { --k-cyan: {{ section.settings.accent_color | default: '#00D1FF' }}; --k-dark: #050505; }
  .trust-bar-section { background-color: #000; padding: 40px 0; border-top: 1px solid #1a1a1a; font-family: 'Inter', sans-serif; }
  .trust-bar-grid { 
    display: grid; 
    grid-template-columns: repeat({{ section.blocks.size }}, 1fr); 
    gap: 15px; 
    max-width: 1400px; 
    margin: 0 auto; 
    padding: 0 20px; 
  }
  .trust-item-wrapper { background: var(--k-dark); border-radius: 12px; border: 1px solid #1a1a1a; transition: 0.3s; overflow: hidden; position: relative; }
  .trust-item-wrapper:hover { border-color: var(--k-cyan); }
  .trust-item-wrapper.is-active { border-color: var(--k-cyan); box-shadow: 0 0 15px rgba(0, 209, 255, 0.1); }
  
  .trust-header { display: flex; align-items: center; gap: 10px; padding: 15px; cursor: pointer; }
  .trust-icon-wrapper { width: 24px; color: var(--k-cyan); display: flex; align-items: center; }
  .trust-icon-wrapper img { width: 100%; height: auto; filter: brightness(0) invert(1) sepia(1) saturate(5) hue-rotate(175deg); } /* Aplica color cyan a iconos negros/blancos */
  
  .trust-text { display: flex; flex-direction: column; }
  .trust-title { color: #fff; font-weight: 700; font-size: 11px; text-transform: uppercase; display: block; }
  .trust-subtitle { color: #666; font-size: 10px; }
  
  .trust-content { max-height: 0; overflow: hidden; transition: 0.3s ease-out; background: #080808; padding: 0 15px; }
  .trust-item-wrapper.is-active .trust-content { max-height: 500px; padding: 10px 15px 20px 15px; border-top: 1px solid #1a1a1a; }
  
  .add-block-info {
    background: rgba(0, 209, 255, 0.05);
    border: 1px dashed var(--k-cyan);
    padding: 10px;
    border-radius: 6px;
    margin-bottom: 12px;
  }
  .add-block-info p { color: #eee; font-size: 10px; margin: 0; line-height: 1.4; }

  .trust-form { display: flex; flex-direction: column; gap: 8px; margin-top: 5px; }
  .trust-input { 
    background: #111; border: 1px solid #222; color: #fff; padding: 8px; 
    border-radius: 4px; font-size: 10px; outline: none; width: 100%; box-sizing: border-box;
  }
  
  .trust-btn { 
    background: var(--k-cyan); color: #000; border: none; width: 100%; 
    padding: 10px; border-radius: 5px; font-weight: 800; font-size: 10px; 
    cursor: pointer; transition: 0.3s; text-transform: uppercase; text-decoration: none; display: block; text-align: center;
  }
  .trust-btn:hover { background: #fff; }

  @media (max-width: 1000px) { .trust-bar-grid { grid-template-columns: 1fr 1fr; } }
  @media (max-width: 600px) { .trust-bar-grid { grid-template-columns: 1fr; } }
</style>

<section class="trust-bar-section">
  <div class="trust-bar-grid">
    
    {% for block in section.blocks %}
      <div class="trust-item-wrapper" {{ block.shopify_attributes }}>
        <div class="trust-header" onclick="toggleTrust(this)">
          <div class="trust-icon-wrapper">
            {% if block.settings.custom_icon != blank %}
              <img src="{{ block.settings.custom_icon | img_url: '40x' }}" alt="{{ block.settings.title }}">
            {% else %}
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 13l4 4L19 7"></path></svg>
            {% endif %}
          </div>
          <div class="trust-text">
            <span class="trust-title">{{ block.settings.title }}</span>
            <span class="trust-subtitle">{{ block.settings.subtitle }}</span>
          </div>
        </div>
        
        <div class="trust-content">
          {% if block.settings.info_text != blank %}
            <div class="add-block-info">
              <p>{{ block.settings.info_text }}</p>
            </div>
          {% endif %}

          {% case block.type %}
            {% when 'formulario' %}
              <form class="trust-form contact-form-native">
                <input type="text" name="contact[name]" placeholder="Nombre completo" class="trust-input" required>
                <input type="email" name="contact[email]" placeholder="Correo electrónico" class="trust-input" required>
                <input type="text" name="contact[address]" placeholder="Ciudad y Dirección" class="trust-input" required>
                <button type="submit" class="trust-btn">Enviar Formulario</button>
              </form>

            {% when 'link' %}
              <a href="{{ block.settings.button_link }}" class="trust-btn">{{ block.settings.button_text }}</a>

            {% when 'tracking' %}
              <form action="/apps/tracking" method="post" class="trust-form">
                <input type="text" class="trust-input" placeholder="Nro de Guía" required>
                <button type="submit" class="trust-btn">Rastrear</button>
              </form>
          {% endcase %}
        </div>
      </div>
    {% endfor %}

  </div>
</section>

<script>
function toggleTrust(element) {
  const wrapper = element.closest('.trust-item-wrapper');
  const isActive = wrapper.classList.contains('is-active');
  document.querySelectorAll('.trust-item-wrapper').forEach(item => {
    item.classList.remove('is-active');
  });
  if (!isActive) {
    wrapper.classList.add('is-active');
  }
}
</script>

{% schema %}
{
  "name": "Barra de Confianza Pro",
  "max_blocks": 4,
  "settings": [
    {
      "type": "color",
      "id": "accent_color",
      "label": "Color de Acento",
      "default": "#00D1FF"
    }
  ],
  "blocks": [
    {
      "type": "link",
      "name": "Información y Link",
      "settings": [
        { "type": "image_picker", "id": "custom_icon", "label": "Subir Icono (PNG)" },
        { "type": "text", "id": "title", "label": "Título", "default": "Pago Seguro" },
        { "type": "text", "id": "subtitle", "label": "Subtítulo", "default": "Métodos de pago" },
        { "type": "textarea", "id": "info_text", "label": "Texto Informativo", "default": "Aceptamos tarjetas y transferencias." },
        { "type": "text", "id": "button_text", "label": "Texto Botón", "default": "Ver más" },
        { "type": "url", "id": "button_link", "label": "Enlace del botón" }
      ]
    },
    {
      "type": "formulario",
      "name": "Formulario Envío",
      "settings": [
        { "type": "image_picker", "id": "custom_icon", "label": "Subir Icono (PNG)" },
        { "type": "text", "id": "title", "label": "Título", "default": "Envío Gratis" },
        { "type": "text", "id": "subtitle", "label": "Subtítulo", "default": "Rellena tus datos" },
        { "type": "textarea", "id": "info_text", "label": "Texto Informativo" }
      ]
    },
    {
      "type": "tracking",
      "name": "Rastreador",
      "settings": [
        { "type": "image_picker", "id": "custom_icon", "label": "Subir Icono (PNG)" },
        { "type": "text", "id": "title", "label": "Título", "default": "Entrega Rápida" },
        { "type": "text", "id": "subtitle", "label": "Subtítulo", "default": "Seguimiento" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Barra de Confianza Pro",
      "blocks": [
        { "type": "formulario" },
        { "type": "link" },
        { "type": "tracking" },
        { "type": "link" }
      ]
    }
  ]
}
{% endschema %}