<script>
  // Corrección de sintaxis Liquid para evitar el error de guardado
  const shopifyUserData = {
    isLoggedIn: {% if customer %}true{% else %}false{% endif %},
    name: {{ customer.first_name | json | default: '"Invitado"' }},
    email: {{ customer.email | json | default: '""' }},
    lastOrder: {{ customer.last_order.name | json | default: '"Ninguna"' }},
    totalOrders: {{ customer.orders_count | default: 0 }}
  };

  // Función para abrir WhatsApp con los datos capturados
  function openWhatsApp() {
    let msg = "Hola, necesito información sobre un producto.";
    
    if (shopifyUserData.isLoggedIn) {
      msg = `Hola, soy ${shopifyUserData.name} (${shopifyUserData.email}). Necesito ayuda con mi cuenta o mi último pedido ${shopifyUserData.lastOrder}.`;
    }
    
    // Reemplaza TUNUMERO con tu número real (ej: 34600000000)
    window.open(`https://wa.me/TUNUMERO?text=${encodeURIComponent(msg)}`, '_blank');
  }

  // ... (el resto de tus funciones toggleTrust, registerSN, etc.)
</script>